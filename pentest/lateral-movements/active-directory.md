## Active Directory

3rd-party lists

* [S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet - A cheat sheet that contains common enumeration and attack methods for Windows Active Directory](https://github.com/S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet)
* [Windows & Active Directory Exploitation Cheat Sheet and Command Reference](https://casvancooten.com/posts/2020/11/windows-active-directory-exploitation-cheat-sheet-and-command-reference/)
* [RedTeamWing/Hunting-Active-Directory - ä¸ªäººæ•´ç†çš„ä¸€äº›åŸŸæ¸—é€Tricksï¼Œå¯èƒ½æœ‰ä¸€äº›é”™è¯¯](https://github.com/RedTeamWing/Hunting-Active-Directory)
* [Attacking Active Directory: 0 to 0.9](https://zer1t0.gitlab.io/posts/attacking_ad/)

Uncategorized

* [c3c/ADExplorerSnapshot.py - ADExplorerSnapshot.py is an AD Explorer snapshot ingestor for BloodHound - èƒ½å¤Ÿè§£æadsnapshotç”Ÿæˆçš„æ–‡ä»¶](https://github.com/c3c/ADExplorerSnapshot.py)
* [Mr-Un1k0d3r/ADHuntTool - official report for the AdHuntTool. C# Script used for Red Team. It can be used by Cobalt Strike execute-assembly or as standalone executable](https://github.com/Mr-Un1k0d3r/ADHuntTool)
* [edemilliere/ADSI - Active Directory Searcher helper - Invoke-ADSDPropagationå¯ä»¥ç«‹å³åˆ·æ–°SDPropé…ç½®](https://github.com/edemilliere/ADSI)
* [incredibleindishell/Windows-AD-environment-related - This Repository contains the stuff related to windows Active directory environment exploitation - é™¤äº†åˆ©ç”¨å·¥å…·ï¼Œè¿˜åŒ…å«ä¸€ä¸ªADåŸºç¡€åŠ å›ºæ–¹æ¡ˆ](https://github.com/incredibleindishell/Windows-AD-environment-related)
* [p0dalirius/pydsinternals - A Python native library containing necessary classes, functions and structures to interact with Windows Active Directory](https://github.com/p0dalirius/pydsinternals)
* [ShutdownRepo/pywhisker - Python version of the C# tool for "Shadow Credentials" attacks](https://github.com/ShutdownRepo/pywhisker)
* [lkarlslund/adalanche - Active Directory ACL Visualizer - who's really Domain Admin](https://github.com/lkarlslund/adalanche)
* [microsoft/azureadexporter - PowerShell module to export a local copy of all Azure Active Directory configuration settings and objects](https://github.com/microsoft/azureadexporter)
* [joeware: Command line Active Directory query tool](http://www.joeware.net/freetools/tools/adfind/)
* [xforcered/StandIn - StandIn is a small .NET35/45 AD post-exploitation toolkit](https://github.com/xforcered/StandIn)
* [Gerenios/AADInternals - AADInternals PowerShell module for administering Azure AD and Office 365](https://github.com/Gerenios/AADInternals)
  * [AAD Internals å®˜æ–¹ç”¨æ³•ä»‹ç»](https://o365blog.com/aadinternals/#install-aadintptaspy)
* [ANSSI-FR/AD-control-paths - Active Directory Control Paths auditing and graphing tools](https://github.com/ANSSI-FR/AD-control-paths)
* [NetSPI/goddi - goddi (go dump domain info) dumps Active Directory domain information](https://github.com/NetSPI/goddi)
* [sid-500 ç¼–å†™çš„å„ç§PowerShellè„šæœ¬](https://sid-500.com/downloads/)
* [k8gege/k8getPC - Using SMB/Browser Get Lan PC Name & OSversion](https://github.com/k8gege/k8getPC)
* [sensepost/UserEnum - Domain user enumeration tool](https://github.com/sensepost/UserEnum)
* [dev-2null/ADCollector - A lightweight tool to quickly extract valuable information from the Active Directory environment for both attacking and defending](https://github.com/dev-2null/ADCollector)
* [phillips321/adaudit - Powershell script to do domain auditing automation](https://github.com/phillips321/adaudit)
* [sense-of-security/ADRecon - a tool which gathers information about the Active Directory and generates a report which can provide a holistic picture of the current state of the target AD environment](https://github.com/sense-of-security/ADRecon)
* [sixdub/DomainTrustExplorer - Python script for analyis of the "Trust.csv" file generated by Veil PowerView. Provides graph based analysis and output - ç»“åˆ Invoke-MapDomainTrusts ä¸€èµ·ä½¿ç”¨](https://github.com/sixdub/DomainTrustExplorer)
* [DanMcInerney/icebreaker - Gets plaintext Active Directory credentials if you're on the internal network but outside the AD environment](https://github.com/DanMcInerney/icebreaker)
* [Tylous/Vibe - A framework for stealthy domain reconnaissance](https://github.com/Tylous/Vibe)
* [Greenwolf/ntlm_theft - A tool for generating multiple types of NTLMv2 hash theft files by Jacob Wilkin (Greenwolf)](https://github.com/Greenwolf/ntlm_theft)
* [leoloobeek/LAPSToolkit - Tool to audit and attack LAPS environments](https://github.com/leoloobeek/LAPSToolkit)
* [vletoux/MakeMeEnterpriseAdmin - ç”¨é‡‘é’¥åŒ™å¯ä»¥æŠŠ Domain Admins ææƒåˆ° Enterprise Adminsï¼Œè¿™ä¸ªå¯¹mimikatzæ²¡æœ‰ä¾èµ–](https://github.com/vletoux/MakeMeEnterpriseAdmin)
* [samratashok/ADModule - Microsoft signed ActiveDirectory PowerShell module (windows 2016é‡Œé¢å¤åˆ¶å‡ºæ¥çš„ï¼Œæœ‰ç­¾åï¼Œå¯ä»¥ç»•è¿‡CLMé™åˆ¶)](https://github.com/samratashok/ADModule)
* [lazywinadmin/AdsiPS - PowerShell module to interact with Active Directory using ADSI and the System.DirectoryServices namespace (.NET Framework)](https://github.com/lazywinadmin/AdsiPS)
* [russelltomkins/Active-Directory - Collection of scripts for Querying and Managing Active Directory and Domain Controllers - åŒ…å«ä¸€äº›è´¦å·æŸ¥è¯¢è„šæœ¬ï¼Œæ¯”å¦‚å¯†ç ä¸è¿‡æœŸçš„ã€å¼€å¯äº†kerberos delegationçš„è´¦å·](https://github.com/russelltomkins/Active-Directory)
* [SecureThisShit/WinPwn - Automation for internal Windows Penetrationtest / AD-Security - Still much work to do](https://github.com/SecureThisShit/WinPwn)
* [aas-n/spraykatz - A tool to spray love around the world](https://github.com/aas-n/spraykatz)
* [davidprowe/BadBlood - fills a Microsoft Active Directory Domain with a structure and thousands of objects](https://github.com/davidprowe/BadBlood)

Privilege escalation

* [gdedrouas/Exchange-AD-Privesc - Exchange privilege escalations to Active Directory](https://github.com/gdedrouas/Exchange-AD-Privesc)
* [hausec/ADAPE-Script - Active Directory Assessment and Privilege Escalation Script](https://github.com/hausec/ADAPE-Script)
* [fox-it/Invoke-ACLPwn - a tool that automates the discovery and pwnage of ACLs in Active Directory that are unsafe configured](https://github.com/fox-it/Invoke-ACLPwn)

Relay

* LDAP
  * [zyn3rgy/LdapRelayScan - Check for LDAP protections regarding the relay of NTLM authentication - æ£€æŸ¥LDAPæ˜¯å¦å¼ºåˆ¶ç­¾åï¼Œä»¥åŠLDAPS SSL bindingé™åˆ¶](https://github.com/zyn3rgy/LdapRelayScan)
  * [GoSecure/ldap-scanner - Checks for signature requirements over LDAP](https://github.com/GoSecure/ldap-scanner)
* [gist: PoC MSSQL RCE exploit using Resource-Based Constrained Delegation](https://gist.github.com/3xocyte/0dc0bd4cb48cc7b4075bdc90a1ccc7d3)
* [skorov/ridrelay - Enumerate usernames on a domain where you have no creds by using SMB Relay with low priv - é’“é±¼æˆåŠŸä¼šè‡ªåŠ¨é€šè¿‡SMBæŸ¥è¯¢è´¦å·](https://github.com/skorov/ridrelay)
* [nccgroup/Change-Lockscreen - Offensive tool to trigger network authentications as SYSTEM](https://github.com/nccgroup/Change-Lockscreen)
* [AlteredSecurity/AzureADJoinedMachinePTC - A tool to execute Pass-The-Certificate attack for lateral movement between Azure AD joined machines](https://github.com/AlteredSecurity/AzureADJoinedMachinePTC)
* [leechristensen/SpoolSample - PoC tool to coerce Windows hosts authenticate to other machines via the MS-RPRN RPC interface](https://github.com/leechristensen/SpoolSample)
  * [Hunting in Active Directory: Unconstrained Delegation & Forests Trusts - è¿™æœ‰ä¸ªæ‰“å°æœºçš„è¯´æ˜](https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1)
* [Arno0x/NtlmRelayToEWS - ntlm relay attack to Exchange Web Services](https://github.com/Arno0x/NtlmRelayToEWS)
* [pkb1s/SharpRelay - ç”¨WinDiveræ”¹ç«¯å£æ¥æ¥å—smbæ•°æ®ï¼Œç”¨socks5å®ç°å‡­è¯å‘é€ï¼Œæœ‰ç‚¹éº»çƒ¦](https://github.com/pkb1s/SharpRelay)
* [CCob/lsarelayx - NTLM relaying for Windows made easy - ä¼¼ä¹æ˜¯lsassæ’ä»¶ï¼Œé£é™©å¾ˆé«˜](https://github.com/CCob/lsarelayx)

Authentication

* [topotam/PetitPotam - coerce Windows hosts to authenticate to other machines via MS-EFSRPC EfsRpcOpenFileRaw function](https://github.com/topotam/PetitPotam)
* [vletoux/NTLMInjector - In case you didn't now how to restore the user password after a password reset (get the previous hash with DCSync) - ç›´æ¥è®¾ç½®NTLMå¯†ç ï¼Œç”¨äºæ¢å¤ç°åœºçš„](https://github.com/vletoux/NTLMInjector)
* [eladshamir/Internal-Monologue - Internal Monologue Attack: Retrieving NTLM Hashes without Touching LSASS](https://github.com/eladshamir/Internal-Monologue)
* [3gstudent: é€šè¿‡CredSSPè·å–æ˜æ–‡å¯†ç ï¼Œä¹Ÿä¸éœ€è¦è¯»å–lsass](https://github.com/3gstudent/3gstudent.github.io/blob/47cdaae15d36b78cc34761662a1471dff0223050/_posts/2020-8-6-%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7%E2%80%94%E2%80%94%E9%80%9A%E8%BF%87CredSSP%E5%AF%BC%E5%87%BA%E7%94%A8%E6%88%B7%E7%9A%84%E6%98%8E%E6%96%87%E5%8F%A3%E4%BB%A4.md)

Mimikatz

* [skelsec/pypykatz - Mimikatz implementation in pure Python - è¿™ä¸ªæ”¯æŒåœ¨çº¿å’Œç¦»çº¿æ¨¡å¼ï¼Œè¿˜å®ç°äº†handledupåŠŸèƒ½](https://github.com/skelsec/pypykatz)
* [Flangvik/BetterSafetyKatz - modified fork of SafetyKatz dynamically fetches the latest pre-compiled release of Mimikatz directly from the gentilkiwi GitHub repo, runtime patching on detected signatures and uses @subtee's PE Loader to get it into memory](https://github.com/Flangvik/BetterSafetyKatz)
* [STEALTHbits/poshkatz - PowerShell module for Mimikatz](https://github.com/STEALTHbits/poshkatz)
* [b4rtik/SharpKatz - Porting of mimikatz sekurlsa::logonpasswords, sekurlsa::ekeys and lsadump::dcsync commands](https://github.com/b4rtik/SharpKatz)

AD CS

* [ly4k/Certipy - Python implementation for Active Directory certificate abuse](https://github.com/ly4k/Certipy)
* [GhostPack/Certify - Active Directory certificate abuse](https://github.com/GhostPack/Certify)
* [GhostPack/PSPKIAudit - PowerShell toolkit for AD CS auditing based on the PSPKI toolkit](https://github.com/GhostPack/PSPKIAudit)
* [GhostPack/ForgeCert - use a stolen Certificate Authority (CA) certificate + private key to forge certificates for arbitrary users capable of authentication to Active Directory - æœ‰ä¸ªPDF: Certified Pre-Owned](https://github.com/GhostPack/ForgeCert)

AD IDNS

* [Kevin-Robertson/Powermad - PowerShell MachineAccountQuota and DNS exploit tools - AD-DNSå·¥å…·ã€æœºå™¨è´¦å·å¢åˆ å·¥å…·ã€‚æ™®é€šç”¨æˆ·é»˜è®¤å°±æœ‰æƒé™ï¼Œåªæ˜¯æœ‰é…é¢é™åˆ¶](https://github.com/Kevin-Robertson/Powermad)
  * [MachineAccountQuota is USEFUL Sometimes: Exploiting One of Active Directoryâ€™s Oddest Settings - å¯¹äºéDAè´¦å·ï¼Œæœºå™¨è´¦å·åˆ›å»ºåæ— æ³•åˆ é™¤ï¼›æœºå™¨è´¦å·å¯ä»¥ä¸å¸¦$ï¼Œç”šè‡³ä»¥ç©ºæ ¼ç»“å°¾](https://blog.netspi.com/machineaccountquota-is-useful-sometimes/)
* [dirkjanm/adidnsdump - Active Directory Integrated DNS dumping by any authenticated user](https://github.com/dirkjanm/adidnsdump)
* [b4rtik/SharpAdidnsdump - c# implementation of Active Directory Integrated DNS dumping (authenticated user)](https://github.com/b4rtik/SharpAdidnsdump)
* [kurtfalde/DNS-Debug - Script to enabled DNS Debug Logging across Domain Controllers in a Forest and then retrieve for analysis](https://github.com/kurtfalde/DNS-Debug)

DSC

* [matthastings/DSCompromised - PowerShell framework for managing and infecting systems via Windows Desired State Configuration (DSC) - éœ€è¦Windows 2012ä»¥ä¸Šç³»ç»Ÿ](https://github.com/matthastings/DSCompromised)
* [specterops: Abusing PowerShell Desired State Configuration for Lateral Movement](https://posts.specterops.io/abusing-powershell-desired-state-configuration-for-lateral-movement-ca42ddbe6f06)  

## Resources

Uncategorized

* [ä» mimikatz å­¦ä¹  Windows å®‰å…¨ä¹‹è®¿é—®æ§åˆ¶æ¨¡å‹ï¼ˆäºŒï¼‰](https://paper.seebug.org/1672/)
* [googleprojectzero: Using Kerberos for Authentication Relay Attacks](https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html)
* [googleprojectzero: Windows Exploitation Tricks: Relaying DCOM Authentication](https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html)
  * [twitter: "Relaying Kerberos only using native Windows is soğŸ”¥ As a normal user we can trigger a Kerberos authentication for SYSTEM that we can relay to services such as LDAP to read LAPS or configure rbcd. Privesc/Lateral movement in any network without enforced signing, which is default - æœ‰äººå·²ç»å®ç°äº†ï¼Œå¹¶å‘½åä¸ºLocalPotatoï¼›æœ‰äº†æœºå™¨è´¦å·ï¼Œé™¤äº†æŸ¥è¯¢LAPSå¯†ç ï¼Œè¿˜èƒ½åšä»€ä¹ˆï¼Ÿ](https://twitter.com/cube0x0/status/1468860246307258370)

Delegation

* https://cube0x0.github.io/Pocing-Beyond-DA/
* https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html
* [No Shells Required - a Walkthrough on Using Impacket and Kerberos to Delegate Your Way to DA](http://blog.redxorblue.com/2019/12/no-shells-required-using-impacket-to.html)
* [dirkjanm.io: The worst of both worlds: Combining NTLM Relaying and Kerberos delegation - é€šè¿‡WPADåŠ«æŒæ”»å‡»åŸè®¾å¤‡ï¼Œç„¶åé€šè¿‡CIFS S4Uæ§åˆ¶ç›®æ ‡è®¾å¤‡](https://dirkjanm.io/worst-of-both-worlds-ntlm-relaying-and-kerberos-delegation/)
  * [potatoSec: æ¸—é€å°è®° - ä¸­ç»§å’Œå§”æ´¾çš„å®æˆ˜åˆ©ç”¨ - é€šè¿‡mS-DS-CreatorSIDç¡®è®¤è®¡ç®—æœºè®¾å¤‡å¤§éƒ½æ˜¯ç”¨æˆ·æ‹‰å…¥åŸŸçš„ï¼Œæ”»å‡»æ–¹æ³•åŒä¸Š](https://www.cnblogs.com/potatsoSec/p/14260648.html)
* [pentestlab.blog: Resource Based Constrained Delegation - åŒ…å«ä¸€ä¸ªåˆ©ç”¨COMè¿œç¨‹æ¿€æ´»WebClientæœåŠ¡çš„ä»£ç ï¼Œé€šè¿‡å¼ºè¡Œé”å®šWorkstationè§¦å‘æœºå™¨è´¦å·è®¤è¯](https://pentestlab.blog/2021/10/18/resource-based-constrained-delegation/)
